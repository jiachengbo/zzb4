"use strict";var path=require("path"),fs=require("fs"),router=require("express").Router(),config=require(path.resolve("./config/config")),docConvPolicy=require("../policies/docconv.server.policy"),docConvs=require("../controllers/docconv.server.controller"),logger=require(path.resolve("./config/lib/logger"));module.exports=function(e){if(config.sofficePathName){if(!fs.existsSync(config.sofficePathName))return void logger.error("soffice file pathname %s not exists",config.sofficePathName);router.route("/:docfile").all(docConvPolicy.isAllowed).get(docConvs.read),router.param("docfile",docConvs.docfile),e.use("/api/docconv",router),logger.debug("soffice pathname %s to use to convert file",config.sofficePathName)}};