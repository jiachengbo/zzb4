"use strict";var acl=require("acl");acl=new acl(new acl.memoryBackend),exports.invokeRolesPolicies=function(){acl.allow([{roles:["user"],allows:[{resources:"/",permissions:"*"},{resources:"/:docfile",permissions:"*"}]}])},exports.isAllowed=function(e,s,r){if(!e.user)return s.status(401).send("Unexpected null user error");var o=e.user.roles;acl.areAnyRolesAllowed(o,e.route.path,e.method.toLowerCase(),function(e,l){return e?s.status(500).send("Unexpected authorization error"):l?r():(console.log(o),s.status(403).json({message:"User is not authorized"}))})};